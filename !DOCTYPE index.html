<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>S·ªï Chi Ti√™u</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',sans-serif}
body{background:#f5f7fa;padding:20px}
.container{max-width:1100px;margin:auto}
header{text-align:center;margin-bottom:20px}
header h1{color:#4F8EF7}
.total{font-size:22px;font-weight:600;margin-top:10px}
.card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,0.05);margin-bottom:20px}
form{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px}
input,select,button{padding:8px;border-radius:8px;border:1px solid #ddd}
button{background:#4F8EF7;color:#fff;border:none;cursor:pointer}
button:hover{opacity:0.9}
.dashboard{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.list-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-bottom:1px solid #eee}
.list-item small{color:gray}
.delete-btn{background:#ff5c5c;padding:4px 8px;font-size:12px}
@media(max-width:768px){
.dashboard{grid-template-columns:1fr}
}
</style>
</head>
<body>

<div class="container">
<header>
<h1>üìä S·ªï Chi Ti√™u</h1>
<div class="total">T·ªïng ƒë√£ chi: <span id="total">0</span> VNƒê</div>
</header>

<div class="card">
<form id="expenseForm">
<input type="number" id="amount" placeholder="S·ªë ti·ªÅn" required>
<select id="category">
<option>ƒÇn u·ªëng</option>
<option>ƒêi l·∫°i</option>
<option>H·ªçc t·∫≠p</option>
<option>Gi·∫£i tr√≠</option>
<option>Kh√°c</option>
</select>
<input type="text" id="description" placeholder="M√¥ t·∫£">
<input type="date" id="date" required>
<button type="submit">Th√™m</button>
</form>
</div>

<div class="dashboard">
<div class="card">
<canvas id="chart"></canvas>
</div>

<div class="card">
<h3>Danh s√°ch chi ti√™u</h3>
<div id="expenseList"></div>
</div>
</div>
</div>

<script>
let expenses = JSON.parse(localStorage.getItem("expenses")) || [];

const form = document.getElementById("expenseForm");
const totalDisplay = document.getElementById("total");
const expenseList = document.getElementById("expenseList");

const ctx = document.getElementById("chart").getContext("2d");

let chart = new Chart(ctx,{
type:'pie',
data:{
labels:["ƒÇn u·ªëng","ƒêi l·∫°i","H·ªçc t·∫≠p","Gi·∫£i tr√≠","Kh√°c"],
datasets:[{data:[0,0,0,0,0]}]
}
});

function saveData(){
localStorage.setItem("expenses",JSON.stringify(expenses));
}

function updateUI(){
expenseList.innerHTML="";
let total = 0;

let categoryTotals={
"ƒÇn u·ªëng":0,
"ƒêi l·∫°i":0,
"H·ªçc t·∫≠p":0,
"Gi·∫£i tr√≠":0,
"Kh√°c":0
};

expenses.slice().reverse().forEach((exp,index)=>{
total+=exp.amount;
categoryTotals[exp.category]+=exp.amount;

let div=document.createElement("div");
div.className="list-item";
div.innerHTML=`
<div>
<strong>${exp.amount.toLocaleString()} VNƒê</strong>
<br>
<small>${exp.category} - ${exp.description || ""} (${exp.date})</small>
</div>
<button class="delete-btn" onclick="deleteExpense(${expenses.length-1-index})">X√≥a</button>
`;
expenseList.appendChild(div);
});

totalDisplay.textContent = total.toLocaleString();

chart.data.datasets[0].data = Object.values(categoryTotals);
chart.update();
}

function deleteExpense(index){
expenses.splice(index,1);
saveData();
updateUI();
}

form.addEventListener("submit",(e)=>{
e.preventDefault();

let amount=parseFloat(document.getElementById("amount").value);
let category=document.getElementById("category").value;
let description=document.getElementById("description").value;
let date=document.getElementById("date").value;

if(amount<=0) return;

expenses.push({amount,category,description,date});
saveData();
updateUI();
form.reset();
});

updateUI();
</script>

</body>
</html>
